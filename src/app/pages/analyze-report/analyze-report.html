<!-- analyze-report.component.html -->
<div class="main-container">
  <div class="report-container">
    <header class="report-header">
      <img
        src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/NASA_logo.svg/2560px-NASA_logo.svg.png"
        alt="NASA Logo"
        class="nasa-logo"
      />
      <h1>ğŸ“Š Informe de AnÃ¡lisis Ambiental</h1>
      <p class="subtitle">
        Generado con datos satelitales y abiertos (NASA POWER, OSM, WorldPop, GIBS)
      </p>
    </header>

    <div *ngIf="data; else noData" class="scrollable-content">
      <!-- ğŸŒ UBICACIÃ“N -->
      <div class="card card-location">
        <h2>ğŸŒ UbicaciÃ³n</h2>
        <div class="info-grid">
          <p><strong>Latitud:</strong> {{ data.location.lat }}</p>
          <p><strong>Longitud:</strong> {{ data.location.lon }}</p>
          <p><strong>PaÃ­s (ISO3):</strong> {{ data.location.iso3 }}</p>
        </div>
      </div>

      <!-- ğŸ‘¥ POBLACIÃ“N -->
      <div class="card card-population">
        <h2>ğŸ‘¥ PoblaciÃ³n</h2>
        <p><strong>{{ data.population?.title }}</strong></p>
        <p>{{ data.population?.desc }}</p>

        <div class="img-wrapper" *ngIf="data.population?.url_img">
          <img [src]="data.population.url_img" alt="Mapa de poblaciÃ³n" />
          <p class="img-caption">ğŸ—ºï¸ DistribuciÃ³n poblacional (WorldPop 2020)</p>
        </div>

        <p>
          <strong>Fuente:</strong>
          <a [href]="data.population?.url_summary" target="_blank">
            WorldPop, University of Southampton
          </a>
        </p>
      </div>

      <!-- ğŸŒ¦ï¸ CLIMA -->
      <div class="card card-climate">
        <h2>ğŸŒ¦ï¸ Clima (NASA POWER)</h2>
        <div *ngIf="getClimateSummary() as clima">
          <div class="climate-stats">
            <div class="stat">
              <p>ğŸŒ¡ï¸ <strong>Temperatura promedio</strong></p>
              <h3>{{ clima.avgTemp }} Â°C</h3>
            </div>
            <div class="stat">
              <p>ğŸ’§ <strong>PrecipitaciÃ³n promedio</strong></p>
              <h3>{{ clima.avgPrec }} mm/dÃ­a</h3>
            </div>
          </div>
        </div>
        <p class="note">Datos procesados desde la API de NASA POWER (Ãºltimos 7 dÃ­as).</p>
      </div>

      <!-- ğŸ’§ CUERPOS DE AGUA -->
      <div class="card card-water">
        <h2>ğŸ’§ Cuerpos de Agua Cercanos</h2>
        <p>
          Se identificaron <strong>{{ data.water?.count || 0 }}</strong> cuerpos de agua dentro
          de un radio de 5 km.
        </p>
        <p class="note">Datos obtenidos de OpenStreetMap (Overpass API).</p>
      </div>

      <!-- ğŸ›°ï¸ IMAGEN SATELITAL -->
      <div class="card card-gibs" *ngIf="data.gibs?.imageUrl">
        <h2>ğŸ›°ï¸ Imagen Satelital</h2>
        <div class="img-wrapper">
          <img [src]="data.gibs.imageUrl" alt="Imagen satelital NASA GIBS" />
          <p class="img-caption">ğŸŒ Imagen satelital NASA GIBS (MODIS TrueColor)</p>
        </div>
      </div>

      <!-- ğŸ” INTERPRETACIÃ“N -->
      <div class="card card-analysis">
        <h2>ğŸ” InterpretaciÃ³n Ambiental</h2>
        <div *ngIf="getClimateSummary() as clima" class="insight-grid">
          <div class="insight-card warm" *ngIf="+clima.avgTemp > 25">
            â˜€ï¸ <strong>Zona cÃ¡lida:</strong> PodrÃ­a presentar estrÃ©s hÃ­drico en Ã©pocas secas.
          </div>

          <div
            class="insight-card mild"
            *ngIf="+clima.avgTemp <= 25 && +clima.avgTemp >= 15"
          >
            ğŸŒ¤ï¸ <strong>Clima templado:</strong> Condiciones ideales para la vegetaciÃ³n moderada.
          </div>

          <div class="insight-card cold" *ngIf="+clima.avgTemp < 15">
            â„ï¸ <strong>Zona frÃ­a:</strong> Menor evapotranspiraciÃ³n, riesgo bajo de sequÃ­a.
          </div>

          <div class="insight-card rain" *ngIf="+clima.avgPrec > 5">
            ğŸŒ§ï¸ <strong>Alta precipitaciÃ³n:</strong> Posible riesgo de inundaciones o suelos saturados.
          </div>

          <div class="insight-card dry" *ngIf="+clima.avgPrec <= 5">
            ğŸ”¥ <strong>Baja precipitaciÃ³n:</strong> Riesgo de sequÃ­as prolongadas o escasez de agua.
          </div>

          <div class="insight-card water" *ngIf="data.water?.count > 0">
            ğŸ’¦ <strong>Presencia hÃ­drica:</strong> Se detectan fuentes de agua cercanas Ãºtiles para riego.
          </div>

          <div class="insight-card no-water" *ngIf="data.water?.count === 0">
            ğŸš« <strong>Sin cuerpos de agua visibles:</strong> Posible vulnerabilidad hÃ­drica local.
          </div>
        </div>
        <p class="note">
          âš ï¸ Estas observaciones son en base a la DATA obtenidad por los satelites de la NASA.
        </p>
      </div>

      <!-- ğŸ”— FUENTES -->
      <div class="card card-sources">
        <h2>ğŸ”— Fuentes de Datos</h2>
        <ul>
          <li><a href="https://power.larc.nasa.gov/" target="_blank">NASA POWER</a></li>
          <li><a href="https://gibs.earthdata.nasa.gov/" target="_blank">NASA GIBS</a></li>
          <li><a href="https://hub.worldpop.org/" target="_blank">WorldPop</a></li>
          <li><a href="https://www.openstreetmap.org/" target="_blank">OpenStreetMap</a></li>
        </ul>
      </div>

      <div class="back-btn">
        <button routerLink="/map">â¬…ï¸ Volver al mapa</button>
      </div>
    </div>

    <ng-template #noData>
      <p class="no-data">âš ï¸ No hay datos cargados. Regresa al mapa e inicia un nuevo anÃ¡lisis.</p>
    </ng-template>
  </div>
</div>
