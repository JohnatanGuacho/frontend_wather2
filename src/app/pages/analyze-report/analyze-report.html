<!-- analyze-report.component.html -->
<div class="main-container">
  <div class="report-container">

    <!-- HEADER -->
    <header class="report-header">
      <div class="logo-orb">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/NASA_logo.svg/2560px-NASA_logo.svg.png"
          alt="NASA Logo" />
      </div>

      <h1 class="page-title">Informe de AnÃ¡lisis Ambiental</h1>
      <p class="subtitle is-white">
        Generado con datos satelitales y abiertos (NASA POWER, OSM, WorldPop, GIBS)
      </p>
      <div class="divider"></div>
    </header>

    <!-- CONTENIDO -->
    <div *ngIf="data; else noData" class="content">

      <!-- ğŸŒ UBICACIÃ“N (mejorada) -->
      <section class="card card-location">
        <h2 class="section-title"><span>ğŸŒ</span> UbicaciÃ³n</h2>
        <p class="loc-sub">Coordenadas de referencia</p>

        <div class="chip-row fancy-chips">
          <div class="chip chip-lat">
            <i class="chip-ico">ğŸ§­</i>
            <div class="chip-body">
              <small>Latitud</small>
              <strong>{{ data.location.lat }}</strong>
            </div>
          </div>

          <div class="chip chip-lon">
            <i class="chip-ico">ğŸ§­</i>
            <div class="chip-body">
              <small>Longitud</small>
              <strong>{{ data.location.lon }}</strong>
            </div>
          </div>

          <div class="chip chip-iso">
            <i class="chip-ico">ğŸ³ï¸</i>
            <div class="chip-body">
              <small>PaÃ­s (ISO3)</small>
              <strong>{{ data.location.iso3 }}</strong>
            </div>
          </div>
        </div>
      </section>

      <!-- ğŸ‘¥ POBLACIÃ“N -->
      <section class="card card-population">
        <h2 class="section-title"><span>ğŸ‘¥</span> PoblaciÃ³n</h2>

        <p class="lead"><strong>{{ data.population?.title }}</strong></p>
        <p>{{ data.population?.desc }}</p>

        <figure class="img-wrapper" *ngIf="data.population?.url_img">
          <img [src]="data.population.url_img" alt="Mapa de poblaciÃ³n" />
          <figcaption class="img-caption">WorldPop 2020 â€” DistribuciÃ³n poblacional</figcaption>
        </figure>

        <p class="meta">
          <span>Fuente:</span>
          <a [href]="data.population?.url_summary" target="_blank" rel="noopener">
            WorldPop, University of Southampton
          </a>
        </p>
      </section>

      <!-- ğŸŒ¦ï¸ CLIMA -->
      <section class="card card-climate">
        <h2 class="section-title"><span>ğŸŒ¦ï¸</span> Clima (NASA POWER)</h2>
        <div *ngIf="getClimateSummary() as clima" class="stat-grid">
          <div class="stat">
            <p>Temperatura promedio</p>
            <h3>{{ clima.avgTemp }} Â°C</h3>
          </div>
          <div class="stat">
            <p>PrecipitaciÃ³n promedio</p>
            <h3>{{ clima.avgPrec }} mm/dÃ­a</h3>
          </div>
        </div>
        <p class="note">Datos de los Ãºltimos 7 dÃ­as (NASA POWER).</p>
      </section>

      <!-- ğŸ’§ CUERPOS DE AGUA -->
      <section class="card card-water">
        <h2 class="section-title"><span>ğŸ’§</span> Cuerpos de Agua Cercanos</h2>
        <p>Se identificaron <strong>{{ data.water?.count || 0 }}</strong> cuerpos de agua en un radio de 5 km.</p>
        <p class="note">Fuente: OpenStreetMap (Overpass API).</p>
      </section>

      <!-- ğŸ›°ï¸ IMAGEN SATELITAL -->
      <section class="card card-gibs" *ngIf="data.gibs?.imageUrl">
        <h2 class="section-title"><span>ğŸ›°ï¸</span> Imagen Satelital</h2>
        <figure class="img-wrapper">
          <img [src]="data.gibs.imageUrl" alt="Imagen satelital NASA GIBS" />
          <figcaption class="img-caption">NASA GIBS â€” MODIS TrueColor</figcaption>
        </figure>
      </section>

      <!-- ğŸ” INTERPRETACIÃ“N -->
      <section class="card card-analysis">
        <h2 class="section-title"><span>ğŸ”</span> InterpretaciÃ³n Ambiental</h2>
        <div *ngIf="getClimateSummary() as clima" class="insight-grid">
          <div class="insight warm" *ngIf="+clima.avgTemp > 25">â˜€ï¸ <strong>Zona cÃ¡lida:</strong> posible estrÃ©s hÃ­drico
            en Ã©pocas secas.</div>
          <div class="insight mild" *ngIf="+clima.avgTemp <= 25 && +clima.avgTemp >= 15">ğŸŒ¤ï¸ <strong>Clima
              templado:</strong> condiciones favorables para vegetaciÃ³n moderada.</div>
          <div class="insight cold" *ngIf="+clima.avgTemp < 15">â„ï¸ <strong>Zona frÃ­a:</strong> baja evapotranspiraciÃ³n.
          </div>
          <div class="insight rain" *ngIf="+clima.avgPrec > 5">ğŸŒ§ï¸ <strong>Alta precipitaciÃ³n:</strong> riesgo de suelos
            saturados/inundaciones.</div>
          <div class="insight dry" *ngIf="+clima.avgPrec <= 5">ğŸ”¥ <strong>Baja precipitaciÃ³n:</strong> sequÃ­as
            prolongadas.</div>
          <div class="insight water" *ngIf="data.water?.count > 0">ğŸ’¦ <strong>Presencia hÃ­drica:</strong> posibles
            fuentes de riego.</div>
          <div class="insight nowater" *ngIf="data.water?.count === 0">ğŸš« <strong>Sin cuerpos de agua:</strong>
            vulnerabilidad hÃ­drica local.</div>
        </div>
        <p class="note">Observaciones indicativas; no sustituyen estudios in situ.</p>
      </section>

      <!-- ğŸ”— FUENTES -->
      <section class="card card-sources">
        <h2 class="section-title"><span>ğŸ”—</span> Fuentes de Datos</h2>
        <div class="source-grid">
          <a class="source-card nasa-power" href="https://power.larc.nasa.gov/" target="_blank" rel="noopener">
            <span class="src-icon">ğŸ›°ï¸</span>
            <span class="src-title">NASA POWER</span>
            <span class="src-desc">MeteorologÃ­a y radiaciÃ³n</span>
          </a>
          <a class="source-card nasa-gibs" href="https://gibs.earthdata.nasa.gov/" target="_blank" rel="noopener">
            <span class="src-icon">ğŸ™ï¸</span>
            <span class="src-title">NASA GIBS</span>
            <span class="src-desc">ImÃ¡genes satelitales</span>
          </a>
          <a class="source-card worldpop" href="https://hub.worldpop.org/" target="_blank" rel="noopener">
            <span class="src-icon">ğŸ‘¥</span>
            <span class="src-title">WorldPop</span>
            <span class="src-desc">Densidad poblacional</span>
          </a>
          <a class="source-card osm" href="https://www.openstreetmap.org/" target="_blank" rel="noopener">
            <span class="src-icon">ğŸ—ºï¸</span>
            <span class="src-title">OpenStreetMap</span>
            <span class="src-desc">Vector geogrÃ¡fico (Overpass)</span>
          </a>
        </div>
      </section>
    </div>

    <ng-template #noData>
      <p class="no-data">âš ï¸ No hay datos cargados. Regresa al mapa e inicia un nuevo anÃ¡lisis.</p>
    </ng-template>
  </div>
</div>